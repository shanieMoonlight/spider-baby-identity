import{a as Q,b as ee}from"./chunk-O6EQULGV.js";import{a as k}from"./chunk-TJLYVA2U.js";import{a as Z}from"./chunk-3CINSE24.js";import{a as D}from"./chunk-A4LVP73L.js";import{a as X}from"./chunk-DNILCXFE.js";import{a as H}from"./chunk-E6PBY26I.js";import{a as J,b as K}from"./chunk-J7V4XGIJ.js";import{a as V}from"./chunk-YIT3BSWB.js";import{a as v}from"./chunk-UQNNMBE6.js";import"./chunk-5M6LSHM4.js";import"./chunk-QHIVMJYN.js";import{a as Y}from"./chunk-WKO4SONN.js";import{a as A,b as _,ca as F,d as j,da as $,e as z,f as B,h as G,i as R,m as q,n as W}from"./chunk-VJXHLJA5.js";import"./chunk-YCVKD4PR.js";import{a as T}from"./chunk-CWY6TGXW.js";import"./chunk-CU2LV2W6.js";import"./chunk-ZUYYKIIZ.js";import"./chunk-4XZ6Q3KQ.js";import"./chunk-XWDBGFUP.js";import"./chunk-VVB4K6R7.js";import{p as I,s as L}from"./chunk-Y5WPSY3K.js";import{Aa as w,Da as O,Eb as a,Hc as S,Ia as E,Jb as c,Ob as r,Pb as m,Qb as f,Sb as M,Ub as h,Vb as g,Y as N,ca as d,db as n,ec as l,la as C,ma as y,mc as U,sb as b,xb as p,za as x}from"./chunk-CCUFKVTZ.js";import"./chunk-6MDQTQU3.js";var P=(()=>{class e{_userMgmtIoService=d(D);_accountIoService=d(T);_updateState=F.CreateWithInput(t=>this._userMgmtIoService.updateMember(t)).setSuccessMsgFn((t,o)=>`${o.userName||o.email} updated successfully!`);_myInfoState=F.Create(()=>this._accountIoService.myInfo()).trigger();_states=$.Combine(this._updateState,this._myInfoState);successMsg=this._states.successMsg;errorMsg=this._states.errorMsg;loading=this._states.loading;userData=this._myInfoState.data;updateSuccess=S(()=>!!this._updateState.successMsg()?.length);update=t=>this._updateState.trigger(t);static \u0275fac=function(o){return new(o||e)};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function re(e,s){e&1&&(r(0,"label",5),l(1,"First Name"),m()),e&2&&a("for","firstName")}function ie(e,s){e&1&&(r(0,"label",5),l(1,"Last Name"),m()),e&2&&a("for","lastName")}function ne(e,s){e&1&&(r(0,"label",5),l(1,"Phone Number"),m()),e&2&&a("for","phoneNumber")}function ae(e,s){e&1&&(r(0,"label",5),l(1,"Username"),m()),e&2&&a("for","username")}function me(e,s){e&1&&(r(0,"label",5),l(1,"Email"),m()),e&2&&a("for","email")}function le(e,s){e&1&&(r(0,"label",5),l(1,"2FA Method"),m()),e&2&&a("for","twoFactorProvider")}function se(e,s){if(e&1&&(r(0,"div",1)(1,"h3"),l(2,"Security Settings"),m(),r(3,"div",2)(4,"div",4),p(5,le,2,1,"label",5),f(6,"sb-select",14)(7,"sb-first-error",7),m(),r(8,"div",15)(9,"sb-checkbox",16),l(10," Enable Two-Factor Authentication "),m()()()()),e&2){let t=g();n(5),c(t.showLabels()?5:-1),n(),a("id","twoFactorProvider")("options",s),n(),a("control",t._form.controls.twoFactorProvider)}}var oe=(()=>{class e{_fb=d(q);_phoneFormatter=d(ee);updateSelf=x();showLabels=w(!0);set appUser(t){console.log("UpdateSelfFormComponent: appUser input set",t),this.setFormValues(t),this._appUser.set(t)}twoFactorProviderOptions=w();_appUser=O(void 0);_form=this._fb.nonNullable.group({id:["",[_.required]],firstName:["",[_.minLength(2)]],lastName:["",[_.minLength(2)]],userName:["",[_.minLength(3)]],email:["",[_.required,_.email]],phoneNumber:["",[Q.validator()]],twoFactorProvider:["Email",[_.required]],twoFactorEnabled:[!1]});constructor(){this._form.controls.phoneNumber.valueChanges.subscribe(t=>{if(!t)return;let o=this._phoneFormatter.formatPhoneInternational(t);t!=o&&this._form.controls.phoneNumber.setValue(o)})}setFormValues(t){if(!t){this._form.reset();return}this._form.patchValue({id:t.id,firstName:t.firstName,lastName:t.lastName,userName:t.userName,email:t.email,phoneNumber:t.phoneNumber,twoFactorProvider:t.twoFactorProvider||"Email",twoFactorEnabled:t.twoFactorEnabled||!1})}extractFormValues(t){let o=t.getRawValue();return{id:o.id,firstName:o.firstName,lastName:o.lastName,userName:o.userName,email:o.email,phoneNumber:o.phoneNumber,twoFactorProvider:o.twoFactorProvider,twoFactorEnabled:o.twoFactorEnabled}}update(){if(!this._form.valid)return;let t=this.extractFormValues(this._form);this.updateSelf.emit(t)}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=b({type:e,selectors:[["sb-update-self-form"]],inputs:{showLabels:[1,"showLabels"],appUser:"appUser",twoFactorProviderOptions:[1,"twoFactorProviderOptions"]},outputs:{updateSelf:"updateSelf"},decls:35,vars:20,consts:[[1,"update-self-form",3,"ngSubmit","formGroup","sbFormControlFirstError"],[1,"form-section"],[1,"form-row"],["hidden","","type","text","formControlName","id","placeholder","User ID","sbInputStyle","",3,"id"],[1,"form-group"],[3,"for"],["type","text","formControlName","firstName","placeholder","First Name","sbInputStyle","",3,"id"],[3,"control"],["type","text","formControlName","lastName","placeholder","Last Name","sbInputStyle","",3,"id"],["type","tel","formControlName","phoneNumber","placeholder","Phone Number","sbInputStyle","",3,"id"],["type","text","formControlName","userName","placeholder","Username","sbInputStyle","",3,"id"],["type","email","formControlName","email","placeholder","Email Address","sbInputStyle","",3,"id"],[1,"form-actions"],["type","submit",3,"disabled"],["placeholder","Select 2FA method","formControlName","twoFactorProvider","color","primary",3,"id","options"],[1,"form-group","checkbox-group"],["formControlName","twoFactorEnabled","color","primary"]],template:function(o,i){if(o&1&&(r(0,"form",0),h("ngSubmit",function(){return i.update()}),r(1,"div",1)(2,"h3"),l(3,"Personal Information"),m(),r(4,"div",2),f(5,"input",3),r(6,"div",4),p(7,re,2,1,"label",5),f(8,"input",6)(9,"sb-first-error",7),m()(),r(10,"div",2)(11,"div",4),p(12,ie,2,1,"label",5),f(13,"input",8)(14,"sb-first-error",7),m(),r(15,"div",4),p(16,ne,2,1,"label",5),f(17,"input",9)(18,"sb-first-error",7),m()()(),r(19,"div",1)(20,"h3"),l(21,"Account Information"),m(),r(22,"div",2)(23,"div",4),p(24,ae,2,1,"label",5),f(25,"input",10)(26,"sb-first-error",7),m(),r(27,"div",4),p(28,me,2,1,"label",5),f(29,"input",11)(30,"sb-first-error",7),m()()(),p(31,se,11,4,"div",1),r(32,"div",12)(33,"sb-button",13),l(34," Update "),m()()()),o&2){let u;a("formGroup",i._form)("sbFormControlFirstError",i._form),n(5),a("id","id"),n(2),c(i.showLabels()?7:-1),n(),a("id","firstName"),n(),a("control",i._form.controls.firstName),n(3),c(i.showLabels()?12:-1),n(),a("id","lastName"),n(),a("control",i._form.controls.lastName),n(2),c(i.showLabels()?16:-1),n(),a("id","phoneNumber"),n(),a("control",i._form.controls.phoneNumber),n(6),c(i.showLabels()?24:-1),n(),a("id","username"),n(),a("control",i._form.controls.userName),n(2),c(i.showLabels()?28:-1),n(),a("id","email"),n(),a("control",i._form.controls.email),n(),c((u=i.twoFactorProviderOptions())?31:-1,u),n(2),a("disabled",i._form.invalid)}},dependencies:[W,B,A,j,z,G,R,K,J,v,H,Z,X],styles:["[_nghost-%COMP%]{display:block;max-width:800px;width:100%;border-radius:1rem}.update-self-form[_ngcontent-%COMP%]{width:100%;color:var(--mat-sys-on-surface-container);display:flex;flex-direction:column;gap:2rem}.description[_ngcontent-%COMP%]{text-align:center;color:var(--mat-sys-on-surface-variant);font-size:.95rem;margin-bottom:1rem;line-height:1.4}.form-section[_ngcontent-%COMP%]{border-radius:.75rem;padding:.5rem;margin:.5rem}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.25rem;font-size:1.1rem;font-weight:600;color:var(--mat-sys-on-surface-variant)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}.form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.form-group.checkbox-group[_ngcontent-%COMP%]{align-self:end;padding-bottom:.5rem}label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}sb-button[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.error[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-size:.95rem;margin-top:-.25rem}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1}.form-section[_ngcontent-%COMP%]{padding:1rem}[_nghost-%COMP%]{max-width:100%}}"],changeDetection:0})}return e})();function de(e,s){if(e&1){let t=M();r(0,"sb-update-self-form",5),h("updateSelf",function(i){C(t);let u=g();return y(u.updateSelf(i))}),m()}if(e&2){let t=g();a("appUser",s)("twoFactorProviderOptions",t._twoFactorProviderOptions)}}function pe(e,s){if(e&1){let t=M();r(0,"div",6)(1,"h4"),l(2,"Error"),m(),r(3,"p"),l(4,"User data not available make sure you are logged in."),m(),r(5,"sb-button",7),h("click",function(){C(t);let i=g(2);return y(i.goToLogin())}),l(6," Login "),m()()}}function ce(e,s){if(e&1&&p(0,pe,7,0,"div",6),e&2){let t=g();c(t._showErrors()?0:-1)}}var Re=(()=>{class e{_state=d(P);_router=d(V);_platformId=d(E);_twoFactorOptionsProvider=d(k);_successMsg=this._state.successMsg;_errorMsg=this._state.errorMsg;_loading=this._state.loading;_updateSuccess=this._state.updateSuccess;_userData=this._state.userData;_showErrors=S(()=>!this._loading()&&L(this._platformId));_twoFactorProviderOptions=this._twoFactorOptionsProvider.getOptions();updateSelf=t=>this._state.update(t);goToLogin=()=>this._router.navigateToLogin();static \u0275fac=function(o){return new(o||e)};static \u0275cmp=b({type:e,selectors:[["sb-update-self"]],features:[U([P])],decls:8,vars:4,consts:[[1,"container"],[1,"form-container"],[1,"header"],[1,"form",3,"appUser","twoFactorProviderOptions"],[3,"errorMsg","successMsg","isLoading"],[1,"form",3,"updateSelf","appUser","twoFactorProviderOptions"],[1,"info-card"],["color","error",1,"go-to-login-btn",3,"click"]],template:function(o,i){if(o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),l(4,"Update Your Details"),m()(),p(5,de,1,2,"sb-update-self-form",3)(6,ce,1,1),m()(),f(7,"sb-notifications-modal-mat",4)),o&2){let u;n(5),c((u=i._userData())?5:6,u),n(2),a("errorMsg",i._errorMsg())("successMsg",i._successMsg())("isLoading",i._loading())}},dependencies:[Y,oe,v,I],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;width:calc(100% - 2rem);min-height:calc(100% - 2rem);align-items:center;justify-content:center;padding:1rem}.container[_ngcontent-%COMP%]{width:98%;max-width:800px;display:flex;align-items:center;flex-direction:column;justify-content:center}.form-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;flex-direction:column}.header[_ngcontent-%COMP%]{margin-bottom:3rem}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:.5rem;font-weight:600}.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{text-align:center;color:var(--mat-sys-on-surface-variant);font-size:.95rem;line-height:1.4}.form[_ngcontent-%COMP%]{width:100%}.info-card[_ngcontent-%COMP%]{background:var(--mat-sys-surface-container);border:1px solid var(--mat-sys-outline-variant);border-radius:8px;padding:1rem;margin-top:1rem}.info-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--mat-sys-error);font-size:1.5rem;font-weight:500}.info-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--mat-sys-on-surface);font-size:1rem;line-height:1.4}sb-button[_ngcontent-%COMP%]{margin:2rem 0;width:100%}"],changeDetection:0})}return e})();export{Re as UpdateSelfComponent};
