import{a as T}from"./chunk-V2TZMPJT.js";import{a as ee}from"./chunk-HZ2EKXOK.js";import{a as J,b as Q}from"./chunk-XVK472TK.js";import{a as X,b as Z}from"./chunk-J7V4XGIJ.js";import{a as j}from"./chunk-YIT3BSWB.js";import{a as P}from"./chunk-UQNNMBE6.js";import{a as I}from"./chunk-5M6LSHM4.js";import{a as N}from"./chunk-QHIVMJYN.js";import{a as H}from"./chunk-WKO4SONN.js";import{a as V,b as h,ca as F,d as z,da as U,e as q,f as B,h as Y,i as A,m as G,n as K}from"./chunk-VJXHLJA5.js";import"./chunk-YCVKD4PR.js";import{a as R}from"./chunk-CWY6TGXW.js";import"./chunk-CU2LV2W6.js";import{c as O}from"./chunk-ZUYYKIIZ.js";import"./chunk-4XZ6Q3KQ.js";import"./chunk-XWDBGFUP.js";import"./chunk-VVB4K6R7.js";import"./chunk-Y5WPSY3K.js";import{A as M,Aa as S,Da as E,Eb as s,Gb as _,Hc as p,Jb as b,Ob as r,Pb as a,Qb as c,Ub as d,Y as k,ca as l,db as i,ec as m,f as v,mc as L,p as g,q as y,sb as w,xb as C,za as $}from"./chunk-CCUFKVTZ.js";import{a as W}from"./chunk-6MDQTQU3.js";function ie(o,D){o&1&&(r(0,"label",2),m(1,"Password"),a()),o&2&&s("for","password")}function re(o,D){o&1&&(r(0,"label",2),m(1,"Confirm Password"),a()),o&2&&s("for","confirmPassword")}function ne(o,D){o&1&&(r(0,"span",8),m(1,"Passwords do not match"),a())}var oe=(()=>{class o{fb=l(G);confirmEmail=$();showLabels=S(!0);color=S("primary");set passwordValidators(e){setTimeout(()=>{e?.length?this._form.controls.password.setValidators([h.required,...e]):this._form.controls.password.setValidators([h.required])},500)}showPassword=E(!1);showConfirmPassword=E(!1);_form=this.fb.nonNullable.group({password:["",[h.required,...T.validationArray(6)]],confirmPassword:["",[h.required]]},{validators:T.matchValidator()});submit(){if(!this._form.valid)return;let e={password:this._form.controls.password.value,confirmPassword:this._form.controls.confirmPassword.value};this.confirmEmail.emit(e)}onPasswordToggle=e=>this.showPassword.set(!e);onConfirmPasswordToggle=e=>this.showConfirmPassword.set(!e);static \u0275fac=function(n){return new(n||o)};static \u0275cmp=w({type:o,selectors:[["sb-confirm-email-with-pwd-form"]],inputs:{showLabels:[1,"showLabels"],color:[1,"color"],passwordValidators:"passwordValidators"},outputs:{confirmEmail:"confirmEmail"},decls:16,vars:17,consts:[[1,"confirm-email-pwd-form",3,"ngSubmit","formGroup","sbFormControlFirstError"],[1,"form-group"],[3,"for"],["sbInputWithBtn","",1,"password-input-container",3,"color"],["formControlName","password","placeholder","Enter your password",3,"id","type"],["toggledLabel","Hide password","untoggledLabel","Show password",3,"toggled","color"],[3,"control"],["formControlName","confirmPassword","placeholder","Confirm your password",3,"id","type"],[1,"error"],["type","submit",3,"disabled","color"]],template:function(n,t){n&1&&(r(0,"form",0),d("ngSubmit",function(){return t.submit()}),r(1,"div",1),C(2,ie,2,1,"label",2),r(3,"div",3),c(4,"input",4),r(5,"sb-toggle-icon-button",5),d("toggled",function(u){return t.onPasswordToggle(u)}),a()(),c(6,"sb-first-error",6),a(),r(7,"div",1),C(8,re,2,1,"label",2),r(9,"div",3),c(10,"input",7),r(11,"sb-toggle-icon-button",5),d("toggled",function(u){return t.onConfirmPasswordToggle(u)}),a()(),c(12,"sb-first-error",6),C(13,ne,2,0,"span",8),a(),r(14,"sb-button",9),m(15," Set Password "),a()()),n&2&&(s("formGroup",t._form)("sbFormControlFirstError",t._form),i(2),b(t.showLabels()?2:-1),i(),s("color",t.color()),i(),s("id","password")("type",t.showPassword()?"text":"password"),i(),s("color",t.color()),i(),s("control",t._form.controls.password),i(2),b(t.showLabels()?8:-1),i(),s("color",t.color()),i(),s("id","confirmPassword")("type",t.showConfirmPassword()?"text":"password"),i(),s("color",t.color()),i(),s("control",t._form.controls.confirmPassword),i(),b(t._form.hasError("passwordMismatch")&&t._form.controls.confirmPassword.touched?13:-1),i(),s("disabled",t._form.invalid)("color",t.color()))},dependencies:[K,B,V,z,q,Y,A,Z,X,P,Q,J],styles:["[_nghost-%COMP%]{display:block;max-width:450px;width:100%;border-radius:1rem}.confirm-email-pwd-form[_ngcontent-%COMP%]{width:100%;color:var(--mat-sys-on-surface-container);display:flex;flex-direction:column;gap:1.5rem}.confirm-email-pwd-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:.5rem;font-weight:600}.description[_ngcontent-%COMP%]{text-align:center;color:var(--mat-sys-on-surface-variant);font-size:.95rem;margin-bottom:1rem;line-height:1.4}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}sb-button[_ngcontent-%COMP%]{width:100%}.error[_ngcontent-%COMP%]{color:var(--mat-sys-error);font-size:.95rem;margin-top:-.25rem}.password-input-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:space-between;border:1px solid var(--mat-sys-outline);transition:border-color .3s ease-in-out;border-radius:.5rem;padding-right:1rem}.password-input-container[_ngcontent-%COMP%]:focus-within{border-color:var(--mat-sys-primary)}.password-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{all:unset;padding:.75rem 1rem;font-size:1rem;border-radius:inherit;background-color:transparent;outline:none;flex:1}"],changeDetection:0})}return o})();var x=(()=>{class o{_actRoute=l(N);_ioService=l(R);_userId$=this._actRoute.queryParamMap.pipe(g(e=>e.get(I.Params.USER_ID_KEY)),M(e=>!!e));_userId=O(this._userId$);_token$=this._actRoute.queryParamMap.pipe(g(e=>e.get(I.Params.CONFIRMATION_TOKEN_KEY)),M(e=>!!e));_token=O(this._token$);readyToConfirm=p(()=>!!this._userId()&&!!this._token());invalidDataErrorMsg=p(()=>this.readyToConfirm()?void 0:"Invalid userId or token.");_confirmInputData$=new v;_confirmDto$=y([this._userId$,this._token$,this._confirmInputData$]).pipe(g(([e,n,t])=>W({userId:e,confirmationToken:n},t)));_confirmEmailState=F.CreateWithObservableInput(this._confirmDto$,e=>this._ioService.confirmEmailWithPassword(e)).setSuccessMsgFn((e,n)=>`${n.message||"Email confirmed!."}`);_resendClick$=new v;_resendDto$=y([this._userId$,this._resendClick$]).pipe(g(([e])=>({userId:e})));_resendState=F.CreateWithObservableInput(this._resendDto$,e=>this._ioService.resendEmailConfirmation(e)).setSuccessMsgFn((e,n)=>`${n.message||"Resend confirmation email request is successful."}`);_states=U.Combine(this._resendState,this._confirmEmailState);errorMsg=p(()=>this.invalidDataErrorMsg()||this._states.errorMsg());loading=this._states.loading;resendSuccess=p(()=>!!this._resendState.successMsg()?.length);confirmationSuccess=p(()=>!!this._confirmEmailState.successMsg()?.length);resendSuccessMsg=this._resendState.successMsg;emailConfirmedSuccessMsg=this._confirmEmailState.successMsg;confirmEmail=e=>this._confirmInputData$.next(e);resendConfirmation=()=>this._resendClick$.next();static \u0275fac=function(n){return new(n||o)};static \u0275prov=k({token:o,factory:o.\u0275fac})}return o})();var Re=(()=>{class o{_state=l(x);_router=l(j);_errorMsg=this._state.errorMsg;_loading=this._state.loading;_resendSuccess=this._state.resendSuccess;_emailConfirmedSuccessMsg=this._state.emailConfirmedSuccessMsg;_resendSuccessMsg=this._state.resendSuccessMsg;confirmEmail=e=>this._state.confirmEmail(e);resendConfirmation=()=>this._state.resendConfirmation();goToLogin=()=>this._router.navigateToLogin();static \u0275fac=function(n){return new(n||o)};static \u0275cmp=w({type:o,selectors:[["sb-confirm-email-with-pwd"]],features:[L([x])],decls:13,vars:13,consts:[[1,"container"],[1,"form"],[1,"description"],[3,"confirmEmail"],[3,"title","message"],["color","primary",1,"go-to-login-btn",3,"click"],["color","error",1,"resend-confirmation-btn",3,"click"],[3,"errorMsg","successMsg","isLoading"]],template:function(n,t){n&1&&(r(0,"div",0)(1,"div",1)(2,"h2"),m(3,"Set Your Password"),a(),r(4,"p",2),m(5,"Create a secure password for your account."),a(),r(6,"sb-confirm-email-with-pwd-form",3),d("confirmEmail",function(u){return t.confirmEmail(u)}),a()(),c(7,"sb-confirmed-card",4),r(8,"sb-button",5),d("click",function(){return t.goToLogin()}),m(9," Login "),a(),r(10,"sb-button",6),d("click",function(){return t.resendConfirmation()}),m(11," Resend Email Confirmation "),a()(),c(12,"sb-notifications-modal-mat",7)),n&2&&(i(),_("hide",t._emailConfirmedSuccessMsg()),i(6),_("show",t._emailConfirmedSuccessMsg()),s("title","Email Confirmed!")("message",t._emailConfirmedSuccessMsg()),i(),_("show",t._resendSuccess()),i(2),_("show",t._errorMsg()),i(2),s("errorMsg",t._errorMsg())("successMsg",t._resendSuccessMsg())("isLoading",t._loading()))},dependencies:[H,oe,ee,P],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;width:calc(100% - 2rem);min-height:calc(100% - 2rem);align-items:center;justify-content:center;padding:1rem}.container[_ngcontent-%COMP%]{width:98%;max-width:1200px;display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1}.container[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:.5rem;font-weight:600}.description[_ngcontent-%COMP%]{text-align:center;color:var(--mat-sys-on-surface-variant);font-size:.95rem;margin-bottom:3rem;line-height:1.4}.form.hide[_ngcontent-%COMP%]{height:0;overflow:hidden;opacity:0;pointer-events:none;transform:translateY(40px) scale(.98);transition:height .3s ease-in-out,opacity .3s ease-in-out,transform .3s ease-in-out}sb-button[_ngcontent-%COMP%]{opacity:0;pointer-events:none;transform:translateY(40px) scale(.98);margin:2rem 0}sb-confirmed-card[_ngcontent-%COMP%]{max-height:1px;overflow:hidden;border-radius:1.25rem;box-shadow:0 4px 24px #3c48581f;max-width:400px;margin:0 auto;transform:translateY(40px) scale(.98);opacity:0;pointer-events:none;transition:opacity .5s .25s cubic-bezier(.4,0,.2,1),transform .5s .25s cubic-bezier(.4,0,.2,1);transition:.5s .25s cubic-bezier(.4,0,.2,1)}sb-confirmed-card.show[_ngcontent-%COMP%], sb-button.show[_ngcontent-%COMP%]{opacity:1;transform:translateY(0) scale(1);pointer-events:auto;margin:2rem auto 1.5rem;max-height:unset;overflow:hidden}"],changeDetection:0})}return o})();export{Re as ConfirmEmailWithPwdComponent};
